{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/burha/Desktop/Sakinaaaaa/Will%20you%20be%20my%20Valentine/src/lib/valentines-store.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { createContext, useContext, useCallback, useEffect, useState } from \"react\";\n\n/**\n * Client-side persisted state for the Valentine flow.\n * Persists to sessionStorage under val_state so it survives route changes and refreshes.\n */\nexport type LastChoicePage2 = \"yes\" | \"hell\" | null;\n\nexport interface ValentinesState {\n  points: number;\n  lastChoicePage2: LastChoicePage2;\n}\n\nconst STORAGE_KEY = \"val_state\";\n\nfunction loadState(): ValentinesState {\n  if (typeof window === \"undefined\") {\n    return { points: 0, lastChoicePage2: null };\n  }\n  try {\n    const raw = sessionStorage.getItem(STORAGE_KEY);\n    if (raw) {\n      const parsed = JSON.parse(raw) as ValentinesState;\n      return {\n        points: typeof parsed.points === \"number\" ? parsed.points : 0,\n        lastChoicePage2:\n          parsed.lastChoicePage2 === \"yes\" || parsed.lastChoicePage2 === \"hell\"\n            ? parsed.lastChoicePage2\n            : null,\n      };\n    }\n  } catch {\n    // ignore\n  }\n  return { points: 0, lastChoicePage2: null };\n}\n\nfunction saveState(state: ValentinesState) {\n  if (typeof window === \"undefined\") return;\n  try {\n    sessionStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n  } catch {\n    // ignore\n  }\n}\n\ninterface ValentinesStoreContextValue {\n  points: number;\n  addPoints: (delta: number) => void;\n  setPoints: (value: number) => void;\n  lastChoicePage2: LastChoicePage2;\n  setLastChoicePage2: (choice: LastChoicePage2) => void;\n}\n\nconst ValentinesStoreContext = createContext<ValentinesStoreContextValue | null>(null);\n\n/**\n * Provider that holds points and lastChoicePage2 and persists them to sessionStorage.\n * Wrap the app (or pages that need it) with this provider.\n */\nexport function ValentinesStoreProvider({ children }: { children: React.ReactNode }) {\n  const [state, setState] = useState<ValentinesState>({ points: 0, lastChoicePage2: null });\n  const [hydrated, setHydrated] = useState(false);\n\n  useEffect(() => {\n    setState(loadState());\n    setHydrated(true);\n  }, []);\n\n  useEffect(() => {\n    if (hydrated) saveState(state);\n  }, [hydrated, state]);\n\n  const addPoints = useCallback((delta: number) => {\n    setState((prev) => ({ ...prev, points: prev.points + delta }));\n  }, []);\n\n  const setPoints = useCallback((value: number) => {\n    setState((prev) => ({ ...prev, points: value }));\n  }, []);\n\n  const setLastChoicePage2 = useCallback((choice: LastChoicePage2) => {\n    setState((prev) => ({ ...prev, lastChoicePage2: choice }));\n  }, []);\n\n  const value: ValentinesStoreContextValue = {\n    points: state.points,\n    addPoints,\n    setPoints,\n    lastChoicePage2: state.lastChoicePage2,\n    setLastChoicePage2,\n  };\n\n  return (\n    <ValentinesStoreContext.Provider value={value}>\n      {children}\n    </ValentinesStoreContext.Provider>\n  );\n}\n\nexport function useValentinesStore() {\n  const ctx = useContext(ValentinesStoreContext);\n  if (!ctx) {\n    throw new Error(\"useValentinesStore must be used within ValentinesStoreProvider\");\n  }\n  return ctx;\n}\n"],"names":[],"mappings":";;;;;;;AAEA;AAFA;;;AAeA,MAAM,cAAc;AAEpB,SAAS;IACP,wCAAmC;QACjC,OAAO;YAAE,QAAQ;YAAG,iBAAiB;QAAK;IAC5C;;;AAiBF;AAEA,SAAS,UAAU,KAAsB;IACvC,wCAAmC;;;AAMrC;AAUA,MAAM,uCAAyB,IAAA,sNAAa,EAAqC;AAM1E,SAAS,wBAAwB,EAAE,QAAQ,EAAiC;IACjF,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAkB;QAAE,QAAQ;QAAG,iBAAiB;IAAK;IACvF,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAC;IAEzC,IAAA,kNAAS,EAAC;QACR,SAAS;QACT,YAAY;IACd,GAAG,EAAE;IAEL,IAAA,kNAAS,EAAC;QACR,IAAI,UAAU,UAAU;IAC1B,GAAG;QAAC;QAAU;KAAM;IAEpB,MAAM,YAAY,IAAA,oNAAW,EAAC,CAAC;QAC7B,SAAS,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,QAAQ,KAAK,MAAM,GAAG;YAAM,CAAC;IAC9D,GAAG,EAAE;IAEL,MAAM,YAAY,IAAA,oNAAW,EAAC,CAAC;QAC7B,SAAS,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,QAAQ;YAAM,CAAC;IAChD,GAAG,EAAE;IAEL,MAAM,qBAAqB,IAAA,oNAAW,EAAC,CAAC;QACtC,SAAS,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,iBAAiB;YAAO,CAAC;IAC1D,GAAG,EAAE;IAEL,MAAM,QAAqC;QACzC,QAAQ,MAAM,MAAM;QACpB;QACA;QACA,iBAAiB,MAAM,eAAe;QACtC;IACF;IAEA,qBACE,8OAAC,uBAAuB,QAAQ;QAAC,OAAO;kBACrC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,MAAM,IAAA,mNAAU,EAAC;IACvB,IAAI,CAAC,KAAK;QACR,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}}]
}